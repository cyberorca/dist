{"version":3,"file":"KLYCreative.floatingPin.1.3.0.4a8de0c5da4b97aa0991.js","mappings":"wGAAO,SAASA,EAAYC,EAAQC,EAAKC,GAiBrC,IACI,IAAIC,EACAC,EACJA,EAoIM,4vJAWwCJ,EAAOK,+SAGnCL,EAAOM,2LAGiDN,EAAOO,uGACLP,EAAOQ,kHAOnFL,EAAsB,6HAERD,uCACWF,EAAOS,WAAWT,EAAOU,+CAC3BV,EAAOW,kDACHX,EAAOY,wKAILZ,EAAOa,4FACMb,EAAOc,wBAAwBd,EAAOe,gDACrDf,EAAOgB,wzMAgIFhB,EAAOK,m0JAmHvC,IAAIY,EAAsBhB,EAAIiB,KAG1BC,EAAsBlB,EAAImB,cAAc,OAC5CD,EAAYE,UAAcjB,EAG1Ba,EAAeK,YAAYH,GAG3B,IAAII,EAAsBtB,EAAImB,cAAc,UAC5CG,EAAgBC,aAAa,OAAQ,wBAGG,IAA7BD,EAAgBE,UACvBF,EAAgBG,YAAcvB,EAE9BoB,EAAgBE,UAAYtB,EAGhCgB,EAAYG,YAAYC,EAC5B,CAAE,MAAOI,GACTC,QAAQC,KAAK,mBAAoBF,EACnC,CACF,C","sources":["webpack://KLYCreative/./src/modules/FloatingPin.js"],"sourcesContent":["export function FloatingPin(config, doc, site) {\n    /**\n     * Config : \n     *  \n        mainImg\n        additionalTracker\n        yesBtnText\n        noBtnText\n        clickUrl\n        landingPage\n        dmpCategory\n        bannerId\n        zoneId\n        disableNoBtn\n        togglerImg\n        logUrl\n     */\n    try {\n        var floating_pin_script ='';\n        var floating_pin_template = '';\n        floating_pin_template = `\n        <sty`+`le>\n            #floating-pin {\n                position: fixed;\n                top: 1000px;\n                left: 0;\n                width: 0;\n                height: 0;\n                z-index: 999999999;\n                visibility: hidden;\n                overflow: hidden;\n            }\n\n            #floating-pin.active {\n                top: 0;\n                visibility: visible;\n                overflow: visible;\n                -webkit-transition: top 1s;\n                -o-transition: top 1s;\n                transition: top 1s;\n                display: block;\n            }\n\n            #floating-pin.landscape {\n                display: none;\n            }\n\n            #floating-pin-toggler {\n                position: absolute;\n                /*width: 90px;\n                height: 90px;*/\n                width: 70px;\n                height: 70px;\n                left: 20px;\n                visibility: hidden;\n            }\n\n            #floating-pin-toggler img {\n                width: 100%;\n            }\n\n            #floating-pin-toggler.active {\n                visibility: visible;\n            }\n\n            #floating-pin-dialogbox-wrapper {\n                position: absolute;\n                top: 0;\n                left: 0;\n                width: 0;\n                height: 0;\n                background: transparent;\n                overflow: hidden;\n                visibility: hidden;\n            }\n\n            #floating-pin-dialogbox-wrapper.active {\n                background: rgba(0, 0, 0, .65);\n                visibility: visible;\n            }\n\n            #floating-pin-dialogbox {\n                position: absolute;\n                display: block;\n                border-radius: 5px;\n                overflow: hidden;\n                -webkit-transform: translateY(900px);\n                -ms-transform: translateY(900px);\n                -o-transform: translateY(900px);\n                transform: translateY(900px);\n                -webkit-transition: transform .7s;\n                -o-transition: transform .7s;\n                transition: transform .7s;\n            }\n\n            #floating-pin-dialogbox-wrapper.active #floating-pin-dialogbox {\n                -webkit-transform: translateY(0);\n                -ms-transform: translateY(0);\n                -o-transform: translateY(0);\n                transform: translateY(0);\n                -webkit-transition: transform .7s;\n                -o-transition: transform .7s;\n                transition: transform .7s;\n            }\n\n            #floating-pin-yes,\n            #floating-pin-no {\n                display: block;\n                width: 100%;\n                font-family: \"Open Sans\", arial, sans-serif;\n                font-weight: 500;\n                font-size: 16px;\n                text-decoration: none;\n                text-align: center;\n                padding: 20px 0;\n                border-bottom: 1px solid #d0d0d0;\n                background: #FFF;\n            }\n\n            #floating-pin-yes {\n                margin-top: -5px;\n            }\n\n            .kl #floating-pin-yes {\n                color: #F39812;\n            }\n\n            .mdk #floating-pin-yes {\n                color: #F70100;\n            }\n\n            #floating-pin-no {\n                color: #7A7A7A;\n            }\n\n            #floating-pin-dialogbox.portrait img {\n                max-width: 100%;\n                max-height: 100%;\n            }\n\n            img#close-floating-pin {\n                position: absolute;\n                z-index: 99999;\n            }\n\n            img#close-floating-pin-toggle{\n                /*left: 110px*/\n                left: 90px; \n                transform: translate(-50%, -50%);\n                z-index: 9999999;\n                position: absolute;\n            }\n        </st`+`yle>\n        <div id=\"floating-pin\" class=\"kl\">\n            <img src=\"https://preview-kmkonline.akamaized.net/banners/images/close-btn2.png\" id=\"close-floating-pin-toggle\">\n            <div onclick=\"togglePopup();\" id=\"floating-pin-toggler\" class=\"active\"><img id=\"floating-pin-toggler-img\" src=\"\" alt=\"\"></div>\n            <div id=\"beacon_toggler\" style=\"position: absolute; left: 0px; top: 0px; visibility: hidden;\">\n                <img id=\"floating-pin-toggler-impr-img\" src=\"#\" style=\"display:none; visibility:hidden;\" width=\"0\" height=\"0\" />\n            </div>\n\n            <div id=\"floating-pin-dialogbox-wrapper\">\n                <img src=\"https://preview-kmkonline.akamaized.net/banners/images/close-btn2.png\" id=\"close-floating-pin\" onclick=\"togglePopup(true,true);\">\n                <div id=\"floating-pin-dialogbox\">\n                    <img id=\"floating-pin-img\" src=\"${config.mainImg}\" alt=\"\">\n                    <div id=\"beacon_dialogbox\" style=\"position: absolute; left: 0px; top: 0px; visibility: hidden;\">\n                        <img id=\"floating-pin-dialogbox-impr-img\" src=\"#\" style=\"display:none; visibility:hidden;\" width=\"0\" height=\"0\" />\n                        ${config.additionalTracker}\n                    </div>\n                    <div id=\"floating-pin-btn-wrapper\">\n                        <div onclick=\"togglePopup(true);\" id=\"floating-pin-yes\">${config.yesBtnText}</div>\n                        <a onclick=\"togglePopup(true,true);\" id=\"floating-pin-no\">${config.noBtnText}</a>\n                    </div>\n                </div>\n            </div>\n        </div>\n        `;\n\n        floating_pin_script = `\n        var pixelImg = 'https://cdns.klimg.com/d.kapanlaginetwork.com/banner/asset/img/pixel.png';\n        var site = \"${site}\";\n        var dfp_landingPage = \"${config.clickUrl}${config.landingPage}\";\n        var togglerImgSrc = \"${config.togglerImg}\";\n        var togglerImprImgSrc = \"${config.logUrl}\";\n        var respondedBanDuration = 360;\n        var triggerScrollTop = 1500;\n        var defaultCookieDuration = 10;\n        var FloatingPin_DMPCat  = '${config.dmpCategory}'.trim().split(/\\\\s*,\\\\s*/);\n        var FloatingPinGAMMacro = '{\"bannerid\":\"${config.bannerId}\",\"zondeId\":\"${config.zoneId}\"}';\n        var DFPDisableCloseBtn = ${config.disableNoBtn};\n\n        var floatingPin = document.getElementById(\"floating-pin\");\n        var floatingpinWrapper = document.getElementById(\"floating-pin-dialogbox-wrapper\");\n        var floatingpinToggler = document.getElementById(\"floating-pin-toggler\");\n        var floatingpinPopup = document.getElementById(\"floating-pin-dialogbox\");\n        var floatingpinImg = document.getElementById(\"floating-pin-img\");\n        var floatingpinYes = document.getElementById(\"floating-pin-yes\");\n        var floatingpinNo = document.getElementById(\"floating-pin-no\");\n        var floatingpinClose = document.getElementById(\"close-floating-pin\");\n        var floatingpinCloseToggle = document.getElementById(\"close-floating-pin-toggle\");\n        var floatingpinTogglerImg = document.getElementById(\"floating-pin-toggler-img\");\n        var floatingpinTogglerImprImg = document.getElementById(\"floating-pin-toggler-impr-img\");\n        var floatingpinDialogBoxImprImg = document.getElementById(\"floating-pin-dialogbox-impr-img\");\n        var floatingpinScrollTop = 0;\n\n        var canScroll = true;\n        var deviceOrientation = \"\";\n        var dfp_floatingPinShown = false;\n        var dfp_popupIsAndroid = false;\n        var dfp_banFloatingPin = getCookieValue(\"dfp_banFloatingPin\");\n        var dfp_popupIsIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);\n        var dfp_popupIsAndroid = dfp_popupIsIOS ? false : /android/i.test(navigator.userAgent);\n\n        if (site.match(/kapanlagi/ig)) {\n            floatingPin.className += \" kl\";\n        } else if (site.match(/merdeka/ig)) {\n            floatingPin.className += \" mdk\";\n        }\n\n        /*if (typeof(window.kmklabs) !== \"undefined\") {\n            gamAddAnimationHeader();\n        }*/\n\n        floatingpinCloseToggle.addEventListener(\"click\", function(){\n            floatingPin.classList.remove(\"active\");\n        });\n\n        function showFloatingPin() {\n            floatingPin.className = \"active\";\n            floatingpinTogglerImg.src = togglerImgSrc;\n            floatingpinYes.addEventListener(\"click\", generateDMPLPFloatingPin);\n            floatingpinTogglerImg.style.border = \"none\";\n            floatingpinTogglerImprImg.src = togglerImprImgSrc;\n            floatingpinWrapper.style.width = window.innerWidth + \"px\";\n            floatingpinWrapper.style.height = window.innerHeight + \"px\";\n            floatingPinVisualCallback();\n            dfp_floatingPinShown = true;\n            if (DFPDisableCloseBtn) {\n                floatingPinDisableClose();\n            }\n        };\n\n        function floatingPinDisableClose() {\n            floatingpinNo.style.display = 'none';\n            floatingpinClose.style.display = 'block';\n            floatingpinWrapper.addEventListener(\"click\", function () {\n                togglePopup(true,true);\n            });\n        \n        }\n\n        function generateDMPLPFloatingPin(){\n            if(typeof parent.window.createDMPTracker === \"function\"){\n                parent.window.createDMPTracker(FloatingPin_DMPCat,dfp_landingPage,FloatingPinGAMMacro);\n            }else{\n                parent.window.open(dfp_landingPage, '_blank');\n            }\n        }\n\n        function floatingPinVisualCallback() {\n\n            floatingpinWrapper.style.width = window.innerWidth + \"px\";\n            floatingpinWrapper.style.height = window.innerHeight + \"px\";\n            /*floatingpinToggler.style.top = ((window.innerHeight / 2) - (floatingpinToggler.offsetHeight / 2) - 20) + \"px\";\n            floatingpinCloseToggle.style.top = ((window.innerHeight / 2) - (floatingpinToggler.offsetHeight / 2) -15) + \"px\";*/\n            \n            floatingpinToggler.style.top = ((window.innerHeight / 2) - (floatingpinToggler.offsetHeight) - 65) + \"px\";\n            floatingpinCloseToggle.style.top = ((window.innerHeight / 2) - (floatingpinToggler.offsetHeight) - 65) + \"px\";\n            \n            \n            var ios = navigator.userAgent.match(/(iPad|iPhone|iPod)/g);\n            var angelOrientation = (ios) ? window.orientation : screen.orientation.angle;\n\n            if (angelOrientation == 0) {\n            \n                deviceOrientation = \"portrait\";\n            \n                if (floatingpinWrapper.className == \"active\") {\n                    floatingPinDisableScroll(true);\n                }\n            \n                floatingPin.className = floatingPin.className.replace(\" landscape\", \"\");\n                floatingpinPopup.className = \"portrait\";\n                floatingpinPopup.style.width = 3 * floatingpinWrapper.offsetWidth / 4 + \"px\";\n                floatingpinPopup.style.left = floatingpinWrapper.offsetWidth / 8 + \"px\";\n                floatingpinPopup.style.top = floatingpinWrapper.offsetHeight / 2 - floatingpinPopup.offsetHeight / 2 + \"px\";\n                floatingpinClose.style.right = \"calc(((100% - \"+floatingpinPopup.style.width +\" ) / 2) - 14px)\";\n                floatingpinClose.style.top = (floatingpinWrapper.offsetHeight / 2 - floatingpinPopup.offsetHeight / 2 ) - 14 + \"px\" ;\n            \n            } else {\n            \n                deviceOrientation = \"landscape\";\n                floatingPinDisableScroll(false);\n                if (!floatingPin.className.match(\"landscape\")) floatingPin.className += \" landscape\";\n                /*floatingpinPopup.className = \"landscape\";\n                floatingpinPopup.style.width = 7 * floatingpinWrapper.offsetWidth / 8 + \"px\";\n                floatingpinPopup.style.left = floatingpinWrapper.offsetWidth / 16 + \"px\";\n                floatingpinPopup.style.top = floatingpinWrapper.offsetHeight / 2 - floatingpinPopup.offsetHeight / 2 + \"px\";*/\n            \n            }\n        \n        };\n\n        function hideOnesignal() {\n            var onesignal = document.getElementById(\"onesignal-popover-container\");\n            if (onesignal) {\n                onesignal.style.display = 'none';\n            }\n        }\n\n        function togglePopup(responded, btnNO) {\n            floatingpinCloseToggle.style.display = 'none';\n            hideOnesignal();\n            if (!new RegExp(\"(s|^)active(s|$)\").test(floatingpinWrapper.className)) {\n                floatingpinWrapper.className = \"active\";\n                floatingpinToggler.className = \"\";\n                floatingpinTogglerImg.src = \"\";\n                floatingpinImg.src = \"${config.mainImg}\";\n                floatingpinTogglerImprImg.src = \"\";\n                floatingpinDialogBoxImprImg.src = pixelImg;\n                floatingPinDisableScroll(true);\n            } else {\n                if (responded) {\n                    var nowDate = new Date();\n                    nowDate.setHours(nowDate.getHours(), nowDate.getMinutes() + respondedBanDuration);\n                    var cookieExpires = nowDate.toGMTString();\n                    setCookie(\"dfp_banFloatingPin\", \"true\", \"/\", cookieExpires);\n                    if (btnNO) {\n                        setTimeout(function() {\n                            floatingpinDialogBoxImprImg.src = pixelImg;\n                        }, 1000);\n                    }\n                    floatingpinDialogBoxImprImg.src = \"\";\n                }\n                floatingpinTogglerImg.src = togglerImgSrc;\n                floatingpinTogglerImprImg.src = togglerImprImgSrc;\n                floatingpinWrapper.className = \"\";\n                floatingpinToggler.className = \"\";\n                floatingPinDisableScroll(false);\n            }\n\n            floatingPinVisualCallback();\n        };\n\n        function getDomainName() {\n            hostName = window.location.hostname;\n            rHN = hostName.substring(hostName.indexOf(\".\") + 1, hostName.length);\n            return (rHN == \"kapanlaginetwork.com\") ? \"kapanlagi.com\" : rHN;\n        };\n\n        function setCookie(cookieName, cookieValue, cookiePath, cookieExpires) {\n            var cookieValue = escape(cookieValue);\n            var banner_cookieDomain = getDomainName();\n            if (cookieExpires == \"\") {\n                var nowDate = new Date();\n                nowDate.setHours(nowDate.getHours(), nowDate.getMinutes() + defaultCookieDuration);\n                cookieExpires = nowDate.toGMTString();\n            }\n            if (cookiePath != \"\") {\n                cookiePath = \";Path=\" + cookiePath;\n            }\n            document.cookie = cookieName + \"=\" + cookieValue + \";expires=\" + cookieExpires + cookiePath + \";Domain=\" + banner_cookieDomain;\n        };\n\n        function getCookieValue(cookieName) {\n            var cookieValue = document.cookie;\n            var cookieStartsAt = cookieValue.indexOf(\" \" + cookieName + \"=\");\n            if (cookieStartsAt == -1) {\n                cookieStartsAt = cookieValue.indexOf(cookieName + \"=\");\n            }\n            if (cookieStartsAt == -1) {\n                cookieValue = null;\n            } else {\n                cookieStartsAt = cookieValue.indexOf(\"=\", cookieStartsAt) + 1;\n                var cookieEndsAt = cookieValue.indexOf(\";\", cookieStartsAt);\n                if (cookieEndsAt == -1) {\n                    cookieEndsAt = cookieValue.length;\n                }\n                cookieValue = unescape(cookieValue.substring(cookieStartsAt, cookieEndsAt));\n            }\n            return cookieValue;\n        };\n\n        function floatingPinDisableScroll(disable) {\n            console.log('floatingPinDisableScroll ' + disable);\n            if (disable) {\n                floatingpinScrollTop = document.body.scrollTop || document.scrollingElement.scrollTop;\n                document.body.style.height = \"100%\";\n                document.body.style.overflow = \"hidden\";\n                document.body.style.marginTop = \"-\"+floatingpinScrollTop+\"px\";\n                canScroll = false;\n            } else {\n                document.body.style.height = \"auto\";\n                document.body.style.overflow = \"auto\";\n                document.body.style.marginTop = \"0px\";\n                document.body.scrollTop = floatingpinScrollTop;\n                document.scrollingElement.scrollTop = floatingpinScrollTop;\n                canScroll = true;\n            }\n            \n            if (typeof(window.kmklabs) !== \"undefined\") {\n                if (typeof(gamHideNavbarST) == \"undefined\") {\n                    gamHideMenubar(disable)\n                }else{\n                    gamHideNavbarST(disable);\n                }\n            }\n        };\n\n        window.addEventListener(\"orientationchange\", function() {\n            floatingPinVisualCallback();\n        });\n        window.addEventListener(\"resize\", function() {\n            floatingPinVisualCallback();\n        });\n        window.addEventListener(\"scroll\", function(e) {\n            var scrollNode = document.scrollingElement || document.documentElement;\n            var scrollTop = scrollNode.scrollTop;\n            if (scrollTop > triggerScrollTop) {\n                if (!dfp_floatingPinShown && !dfp_banFloatingPin) {\n                    showFloatingPin();\n                }\n            }\n        });\n        window.addEventListener(\"touchmove\", function(e) {\n            if (!canScroll) {\n                e.preventDefault();\n            }\n        });\n        `;\n\n        //get frame parent\n        var iframeParentEl      = doc.body;\n\n        //create popup element to containing popup template\n        var containerEl         = doc.createElement('div');\n        containerEl.innerHTML   = floating_pin_template;\n\n        //add popup element to parent frame\n        iframeParentEl.appendChild(containerEl);\n\n        //create container for popup script\n        var containerScript     = doc.createElement('script');\n        containerScript.setAttribute('type', 'text/javascript');\n\n        //assign script o script container, note in firefox innerText not available so use textContent instead\n        if( typeof containerScript.innerText == 'undefined') {\n            containerScript.textContent = floating_pin_script;\n        } else\n            containerScript.innerText = floating_pin_script;\n\n        //add popup script  container to popup element\n        containerEl.appendChild(containerScript);\n    } catch (e) {\n    console.warn(\"[Newstag] Error:\", e);\n  }\n}"],"names":["FloatingPin","config","doc","site","floating_pin_script","floating_pin_template","mainImg","additionalTracker","yesBtnText","noBtnText","clickUrl","landingPage","togglerImg","logUrl","dmpCategory","bannerId","zoneId","disableNoBtn","iframeParentEl","body","containerEl","createElement","innerHTML","appendChild","containerScript","setAttribute","innerText","textContent","e","console","warn"],"ignoreList":[],"sourceRoot":""}