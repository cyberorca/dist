{"version":3,"file":"KLYCreative.floatingPin.1.1.0.a3df8c4306b651bbc8c5.js","mappings":"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","sources":["webpack://KLYCreative/./src/modules/FloatingPin.js"],"sourcesContent":["export function FloatingPin(config, win, doc) {\n    try {\n        // ---------- CONFIG ----------\n        var triggerScrollTop = 1500;\n        // px scroll to trigger popup\n        var respondedBanDurationMinutes = 360;\n        // minutes to ban after user responds\n        var togglerImgSrc = config.togglerImg;\n        var dialogImprSrc = \"https://cdns.klimg.com/d.kapanlaginetwork.com/banner/asset/img/pixel.png\";\n        var cookieName = \"dfp_banFloatingPin\";\n        var landingPage = `${config.clickUrl}${config.landingPage}`;\n\n        // ---------- TEMPLATE (HTML + CSS) ----------\n        var floating_pin_template = `\n        <style id=\"floating-pin-styles\">\n            #floating-pin { position: fixed; top:1000px; left:0; width:0; height:0; z-index:999999999; visibility:hidden; overflow:hidden; }\n            #floating-pin.active { top:0; visibility:visible; overflow:visible; transition: top .5s ease; display:block; }\n            #floating-pin.landscape { /* optional hide rules for landscape if needed */ }\n            #floating-pin-toggler { position: absolute; width: 64px; height:64px; left: 16px; visibility:hidden; cursor:pointer; }\n            #floating-pin-toggler.active { visibility: visible; }\n            #floating-pin-toggler img { width:100%; height:100%; object-fit:contain; display:block; }\n            #floating-pin-dialogbox-wrapper {z-index: 1000000000;position: fixed; top:0; left:0; width:0; height:0; background: transparent; overflow:hidden; visibility:hidden; display:flex; align-items:center; justify-content:center; }\n            #floating-pin-dialogbox-wrapper.active { background: rgba(0,0,0,0.65); visibility: visible; }\n            #floating-pin-dialogbox { position: absolute; display:block; border-radius:10px; overflow:hidden; transform: translateY(0); transition: transform .45s ease; max-width: 77vw; box-sizing: border-box; }\n            #floating-pin-dialogbox-wrapper.active #floating-pin-dialogbox { transform: translateY(0); }\n            #floating-pin-dialogbox img { display:block; width: 100%; height: auto; max-height: 70vh; object-fit:cover; }\n            #floating-pin-btn-wrapper { display:block; background:#fff; }\n            #floating-pin-yes, #floating-pin-no { display:block; width:100%; padding:14px 12px; font-family:Arial,Helvetica,sans-serif; font-size:16px; text-align:center; cursor:pointer; border-top:1px solid #e6e6e6; }\n            #floating-pin-yes { color:#F39812; font-weight:600; }\n            #floating-pin-no { color:#7A7A7A; }\n            img#close-floating-pin, img#close-floating-pin-toggle { position:absolute; width:19px; height:19px; object-fit:contain; cursor:pointer; z-index:1000000000; }\n            img#close-floating-pin-toggle { left: 4px; top: 12px; }\n            img#close-floating-pin { right: calc(50% - 20px); top: 10px; }\n            /* Responsive rules */\n            @media (max-width: 700px) { \n            #floating-pin-toggler { width:56px; height:56px; left:12px; } \n            #floating-pin-dialogbox { width: 92vw; border-radius:8px; } \n            #floating-pin-dialogbox img { max-height: 60vh; } \n            }\n            @media (orientation: landscape) and (max-width: 900px) { \n            /* mobile landscape adjustments */ \n            #floating-pin-dialogbox { max-width: 85vw; } \n            }\n        </style>\n        <div id=\"floating-pin\" class=\"kl\">\n            <img src=\"https://preview-kmkonline.akamaized.net/banners/images/close-btn2.png\" id=\"close-floating-pin-toggle\" alt=\"close toggle\">\n            <div id=\"floating-pin-toggler\" class=\"active\" aria-hidden=\"true\">\n            <img id=\"floating-pin-toggler-img\" src=\"\" alt=\"\">\n            </div>\n            <div id=\"floating-pin-dialogbox-wrapper\" role=\"dialog\" aria-hidden=\"true\">\n            <!--img src=\"https://preview-kmkonline.akamaized.net/banners/images/close-btn2.png\" id=\"close-floating-pin\" alt=\"close\"-->\n            <div id=\"floating-pin-dialogbox\" role=\"document\">\n                <img id=\"floating-pin-img\" src=\"${config.mainImg}\" alt=\"\">\n                <div id=\"beacon_dialogbox\" style=\"position: absolute; left: 0px; top: 0px; visibility: hidden;\">\n                    <img id=\"floating-pin-dialogbox-impr-img\" src=\"${config.logUrl}${dialogImprSrc}\" style=\"display:none; visibility:hidden;\" width=\"0\" height=\"0\" />\n                    ${config.additionalTracker}\n                </div>\n                <div id=\"floating-pin-btn-wrapper\">\n                <div id=\"floating-pin-yes\" role=\"button\" tabindex=\"0\">${config.yesBtnText}</div>\n                <div id=\"floating-pin-no\" role=\"button\" tabindex=\"0\">${config.noBtnText}</div>\n                </div>\n            </div>\n            </div>\n        </div>`;\n\n        // ---------- INJECT into parent DOM ----------\n        var containerEl = doc.createElement(\"div\");\n        containerEl.innerHTML = floating_pin_template;\n        // append as last child to avoid layout shifts near top\n        (doc.body || doc.documentElement).appendChild(containerEl);\n\n        // ---------- GET ELEMENTS (use doc) ----------\n        var floatingPin = doc.getElementById(\"floating-pin\");\n        var wrapper = doc.getElementById(\"floating-pin-dialogbox-wrapper\");\n        var toggler = doc.getElementById(\"floating-pin-toggler\");\n        var togglerImg = doc.getElementById(\"floating-pin-toggler-img\");\n        var closeToggle = doc.getElementById(\"close-floating-pin-toggle\");\n        var closeBtn = doc.getElementById(\"close-floating-pin\");\n        var btnYes = doc.getElementById(\"floating-pin-yes\");\n        var btnNo = doc.getElementById(\"floating-pin-no\");\n\n        // ---------- STATE ----------\n        var dfp_floatingPinShown = false;\n        var dfp_banFloatingPin = getCookie(cookieName) === \"true\";\n        var canScroll = true;\n        var savedScrollTop = 0;\n\n        // ---------- UTIL: orientation check (landscape) ----------\n        function isLandscape() {\n            try {\n                // prefer matchMedia on parent window\n                return win.matchMedia && win.matchMedia(\"(orientation: landscape)\").matches;\n            } catch (e) {\n                // fallback: compare width/height\n                console.warn(e);\n                return win.innerWidth > win.innerHeight;\n            }\n        }\n\n        // ---------- COOKIE HELPERS ----------\n        function setCookieMinutes(name, value, minutes) {\n            try {\n                var d = new Date();\n                d.setTime(d.getTime() + minutes * 60 * 1000);\n                var expires = \"expires=\" + d.toUTCString();\n                doc.cookie = name + \"=\" + encodeURIComponent(value) + \"; \" + expires + \"; path=/\";\n            } catch (e) { // fail silently\n                return `[Error] ${e}`\n            }\n        }\n        function getCookie(name) {\n            try {\n                var re = new RegExp(\"(^| )\" + name + \"=([^;]+)\");\n                var m = doc.cookie.match(re);\n                return m ? decodeURIComponent(m[2]) : null;\n            } catch (e) {\n                console.warn(e);\n                return null;\n            }\n        }\n\n        // ---------- SCROLL LOCK (only when device is landscape) ----------\n        function lockScrollIfLandscape() {\n            if (!isLandscape())\n                return;\n            // do not lock on portrait\n            lockScrollImmediate();\n        }\n\n        function lockScrollImmediate() {\n            try {\n                var body = doc.body;\n                // save current scrollTop\n                savedScrollTop = (doc.scrollingElement && doc.scrollingElement.scrollTop) || doc.documentElement.scrollTop || 0;\n                // apply fixed positioning to freeze scroll\n                body.style.position = \"fixed\";\n                body.style.top = \"-\" + savedScrollTop + \"px\";\n                body.style.left = \"0\";\n                body.style.right = \"0\";\n                body.style.width = \"100%\";\n                canScroll = false;\n            } catch (e) {\n                // fallback: set overflow hidden on documentElement\n                console.error(e);\n                try {\n                    doc.documentElement.style.overflow = \"hidden\";\n                } catch (er) {\n                    console.error(er);\n                }\n                canScroll = false;\n            }\n        }\n\n        function unlockScrollImmediate() {\n            try {\n                var body = doc.body;\n                // remove styles\n                body.style.position = \"\";\n                body.style.top = \"\";\n                body.style.left = \"\";\n                body.style.right = \"\";\n                body.style.width = \"\";\n                // restore scroll position\n                if (doc.scrollingElement)\n                    doc.scrollingElement.scrollTop = savedScrollTop;\n                else\n                    doc.documentElement.scrollTop = savedScrollTop;\n                canScroll = true;\n            } catch (e) {\n                console.error(e);\n                try {\n                    doc.documentElement.style.overflow = \"\";\n                } catch (er) {\n                    console.error(er);\n                }\n                canScroll = true;\n            }\n        }\n\n        // ---------- VISUAL / POSITION ----------\n        function updatePosition() {\n            try {\n                // wrapper to full viewport\n                wrapper.style.width = win.innerWidth + \"px\";\n                wrapper.style.height = win.innerHeight + \"px\";\n\n                // toggler vertical center (small offset)\n                var togglerHeight = toggler ? toggler.offsetHeight || 64 : 64;\n                var topVal = Math.max(12, Math.round(win.innerHeight / 2 - togglerHeight - 40));\n                if (toggler)\n                    toggler.style.top = topVal + \"px\";\n                if (closeToggle)\n                    closeToggle.style.top = (topVal - 8) + \"px\";\n\n                var popup = doc.getElementById(\"floating-pin-dialogbox\");\n                if (popup) {\n                    // desktop: 75% width centered with margin; mobile: full width with padding\n                    var maxW = Math.min(win.innerWidth * 0.92, 640);\n                    popup.style.width = Math.round(maxW) + \"px\";\n                    // popup.style.left = Math.round((win.innerWidth - maxW) / 2) + \"px\";\n                    // compute top so popup is vertically centered (approx)\n                    popup.style.top = Math.max(18, Math.round((win.innerHeight - (popup.offsetHeight || 260)) / 2)) + \"px\";\n                }\n            } catch (e) { // ignore\n                console.error(e);\n            }\n        }\n\n        // ---------- SHOW / TOGGLE ----------\n        function showFloatingPin() {\n            if (dfp_banFloatingPin || dfp_floatingPinShown)\n                return;\n            if (!floatingPin)\n                return;\n\n            floatingPin.classList.add(\"active\");\n            if (togglerImg)\n                togglerImg.src = togglerImgSrc;\n            dfp_floatingPinShown = true;\n\n            // open small toggler visible; do not open dialog automatically\n            if (wrapper)\n                wrapper.classList.remove(\"active\");\n            // lock scroll only if device is landscape\n            lockScrollIfLandscape();\n\n            updatePosition();\n        }\n\n        function openDialog() {\n            if (!wrapper)\n                return;\n            wrapper.classList.add(\"active\");\n            // when dialog opens, lock scroll only in landscape\n            lockScrollIfLandscape();\n            updatePosition();\n        }\n\n        function closeDialog(responded, clickedNo) {\n            // responded: whether user clicked yes/no (should set cookie)\n            \n            if(clickedNo) console.warn(clickedNo);\n\n            if (!wrapper)\n                return;\n            if (responded) {\n                setCookieMinutes(cookieName, \"true\", respondedBanDurationMinutes);\n                dfp_banFloatingPin = true;\n            }\n            wrapper.classList.remove(\"active\");\n            // only unlock if we had locked (and only unlock if still fixed)\n            if (!isLandscape()) { // If portrait, we didn't lock — nothing to do\n            } else {\n                // in landscape we locked earlier; unlock now\n                unlockScrollImmediate();\n            }\n            updatePosition();\n        }\n\n        // Combined toggle used by UI: if wrapper open -> close, else open\n        function togglePopup(responded, clickedNo) {\n            if (!wrapper) {\n                // safe fallback: open dialog element if exists\n                return;\n            }\n            var isOpen = wrapper.classList.contains(\"active\");\n            if (!isOpen) {\n                openDialog();\n            } else {\n                closeDialog(Boolean(responded), clickedNo);\n            }\n        }\n\n        // ---------- EVENT BINDINGS ----------\n        try {\n            if (closeToggle)\n                closeToggle.addEventListener(\"click\", function() {\n                    floatingPin.classList.remove(\"active\");\n                });\n            if (closeBtn)\n                closeBtn.addEventListener(\"click\", function() {\n                    togglePopup(true, true);\n                });\n            if (btnYes)\n                btnYes.addEventListener(\"click\", function() {\n                    // you might want to run tracking logic here\n                    // togglePopup(true, false);\n                    win.open(landingPage, '_blank');\n                });\n            if (btnNo)\n                btnNo.addEventListener(\"click\", function() {\n                    togglePopup(true, true);\n                    floatingPin.classList.remove(\"active\");\n                });\n            if (toggler)\n                toggler.addEventListener(\"click\", function() {\n                    // toggler opens the dialog\n                    openDialog();\n                });\n\n            // keyboard accessibility for yes/no (Enter/Space)\n            function addKeyActivation(el, handler) {\n                if (!el)\n                    return;\n                el.addEventListener(\"keydown\", function(ev) {\n                    if (ev.key === \"Enter\" || ev.key === \" \" || ev.key === \"Spacebar\") {\n                        ev.preventDefault();\n                        handler();\n                    }\n                });\n            }\n            addKeyActivation(btnYes, function() {\n                btnYes.click();\n            });\n            addKeyActivation(btnNo, function() {\n                btnNo.click();\n            });\n\n            // orientation / resize -> recalc\n            win.addEventListener(\"resize\", function() {\n                updatePosition();\n            }, {\n                passive: true\n            });\n\n            win.addEventListener(\"orientationchange\", function() {\n                // if the popup dialog is open, re-evaluate lock/unlock\n                updatePosition();\n                if (wrapper && wrapper.classList.contains(\"active\")) {\n                    // if changed to portrait, unlock; if changed to landscape, lock\n                    if (!isLandscape()) {\n                        // unlock if previously locked\n                        unlockScrollImmediate();\n                    } else {\n                        lockScrollIfLandscape();\n                    }\n                }\n            }, {\n                passive: true\n            });\n\n            // Prevent touchmove when we have locked scroll (passive false so we can preventDefault)\n            win.addEventListener(\"touchmove\", function(e) {\n                if (!canScroll)\n                    e.preventDefault();\n            }, {\n                passive: false\n            });\n\n            // Scroll listener to show toggler/popup on threshold\n            win.addEventListener(\"scroll\", function() {\n                try {\n                    var scrollTop = (doc.scrollingElement && doc.scrollingElement.scrollTop) || doc.documentElement.scrollTop || 0;\n                    if (scrollTop > triggerScrollTop) {\n                        if (!dfp_floatingPinShown && !dfp_banFloatingPin) {\n                            showFloatingPin();\n                        }\n                    }\n                } catch (e) {\n                    console.error(e);\n                    /* ignore */ }\n            }, {\n                passive: true\n            });\n\n            // initial position calculate (in case content already scrolled)\n            updatePosition();\n            // if page already scrolled past threshold at load, show (but still respect cookie)\n            try {\n                var currentScroll = (doc.scrollingElement && doc.scrollingElement.scrollTop) || doc.documentElement.scrollTop || 0;\n                if (currentScroll > triggerScrollTop && !dfp_floatingPinShown && !dfp_banFloatingPin) {\n                    // small timeout to let layout stabilize\n                    setTimeout(showFloatingPin, 120);\n                }\n            } catch (e) {console.error(e);}\n\n        } catch (err) {\n            // fail silently — don't break host page\n            console.error(\"FloatingPin bind error:\", err);\n        }\n\n        // expose a safe API on parent (non-enumerable) so host can programmatically control popup if needed\n        try {\n            if (win && win !== window) {\n                // avoid overwriting existing name\n                win.__FloatingPin = win.__FloatingPin || {\n                    open: function() {\n                        openDialog();\n                    },\n                    close: function() {\n                        closeDialog(false, false);\n                    },\n                    toggle: function(responded, clickedNo) {\n                        togglePopup(responded, clickedNo);\n                    }\n                };\n            } else {\n                // if not in iframe, still expose on local window\n                window.__FloatingPin = window.__FloatingPin || {\n                    open: function() {\n                        openDialog();\n                    },\n                    close: function() {\n                        closeDialog(false, false);\n                    },\n                    toggle: function(responded, clickedNo) {\n                        togglePopup(responded, clickedNo);\n                    }\n                };\n            }\n        } catch (e) {console.error(e);}\n    } catch (e) {\n        console.warn(\"[Floating Pin] Error:\", e);\n    }\n}"],"names":["FloatingPin","config","win","doc","togglerImgSrc","togglerImg","cookieName","landingPage","clickUrl","floating_pin_template","mainImg","logUrl","additionalTracker","yesBtnText","noBtnText","containerEl","createElement","innerHTML","body","documentElement","appendChild","floatingPin","getElementById","wrapper","toggler","closeToggle","closeBtn","btnYes","btnNo","dfp_floatingPinShown","dfp_banFloatingPin","getCookie","canScroll","savedScrollTop","isLandscape","matchMedia","matches","e","console","warn","innerWidth","innerHeight","setCookieMinutes","name","value","minutes","d","Date","setTime","getTime","expires","toUTCString","cookie","encodeURIComponent","re","RegExp","m","match","decodeURIComponent","lockScrollIfLandscape","lockScrollImmediate","scrollingElement","scrollTop","style","position","top","left","right","width","error","overflow","er","unlockScrollImmediate","updatePosition","height","togglerHeight","offsetHeight","topVal","Math","max","round","popup","maxW","min","showFloatingPin","classList","add","src","remove","openDialog","closeDialog","responded","clickedNo","togglePopup","contains","Boolean","addKeyActivation","el","handler","addEventListener","ev","key","preventDefault","open","click","passive","setTimeout","err","window","__FloatingPin","close","toggle"],"ignoreList":[],"sourceRoot":""}